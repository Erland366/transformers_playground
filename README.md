See branches for different implementation on this playground